<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Timer</title>
<style>
  p{
    position: relative; 
    text-align: center;
    top: -200px;
    font-size : 200px; 
  }
  p2{
    position: relative; 
    top: -350px;
    font-size : 200px; 
  }
  button{
    font-size:20pt;
    width:130px;
    height:40px
  }

</style>

<script>


var now;
var s, m, h;
var s0, m0, h0;
var s2=0, m2=0, h2=0;
var s3, m3, h3;

onload = function(){
 msg =  '0:00:00';
 var image=document.getElementById('image');
 image.innerHTML = msg;
}

function showClock(){
 if(str1=='1'){
   now = new Date();
   h0 = now.getHours();
   m0 = now.getMinutes();
   s0 = now.getSeconds(); 
   image2.innerHTML = '';
 }
 
 var now2 = new Date();
 var h1 = h2+now2.getHours();
 var m1 = m2+now2.getMinutes();
 var s1 = s2+now2.getSeconds(); 
  
 if(s1<s0){
   s1=s1+60;
   m1=m1-1;  
 }
   s=s1-s0;
 if(s>=60){
   s=s%60;
   m1+=1;
  }  
 
 if(m1<m0){
   m1=m1+60;
 if(m1>=60){
   m1=m1%60;
   h1+=1;
 }
   h1=h1-1;
 }
  m=m1-m0;
  h=h1-h0;
  if(m<10)
     m=m;

  s3=s;
  if(s3<10)
    s3='0'+s3;
  m3=m;
  if(m3<10)
    m3='0'+m3;
 
 msg = h + ':' + m3 + ':' + s3;
 var image=document.getElementById('image');
 image.innerHTML = msg;

//  console.log(s);
  if(m==4 && s<1){
     image2.innerHTML = '残り１分';
     var aud = document.getElementById("aaa");
     aud.play();  
  } 
  else if(m==4 && s>2){
    image2.innerHTML = '';
  }
  else if(m==5 &&  s<2){
     image2.innerHTML = '講演終了';
     var aud = document.getElementById("aaa");
     aud.play();  
  }  
  else if(m==5 && s>3){
    image2.innerHTML = '';
  }
  else if(m==7 &&  s<3){
     image2.innerHTML = '質問終了';
     var aud = document.getElementById("aaa");
     aud.play();  
  }    
};


var str1=0;  

function onClick3(){ 
  s2=0; m2=0; h2=0;
  setInterval('showClock()', 1000);
  str1=1;
};


function onClick2(){ 
  s2=s; m2=m; h2=h;
  setInterval('showClock()', 1000);
  console.log('h2='+h+' m2='+m+' s2='+s ); 
  str1=1;
};

function onClick(){
  now = new Date();
  h0 = now.getHours();
  m0 = now.getMinutes();
  s0 = now.getSeconds(); 
  setInterval('showClock()', 1000);
  str1=0;
};

function onClick4(){
     var aud = document.getElementById("aaa");
     aud.play();  
};

</script>
</head>

<body>
<button id="btn"  onclick="onClick()">開始</button>
<button id="btn2"  onclick="onClick2()">一時停止</button>
<button id="btn3"  onclick="onClick3()">リセット</button>
<button id="btn4"  onclick="onClick4()">ベル音</button><br>
<p id="image"> </p>
<br>
<center>
<p2 id="image2"></p2>
</center>
<audio id="aaa" src="do.wav"></audio>

</body>
</html> 