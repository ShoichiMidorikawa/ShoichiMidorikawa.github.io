<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135083881-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-135083881-1');
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>

<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META name="GENERATOR" content="JustSystems Homepage Builder Version 18.0.13.0 for Windows">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<style>
table, td {
  margin-left: 100px;
  padding: 3px;
  width: 360px;
}
@media screen and (max-width: 840px){
   body{
     align; left;
     margin-left: 0px;
   }
   table, td{
     padding: 3px;
     margin-left: 0px;
   }
   img{
      width: 100%;
      height: auto;
   }

}

div2{
     align : left ;
}

div.parent{
  text-align: center;
}
div.child{
    text-align: left;
    width: 250px;
    margin: auto;
}
div.child2{
//    background-color: lightblue;
    text-align: left;
    font-size: 18px;
    width: 800px;
    margin: auto;
    padding:6px 6px 6px;
}

code {
  display: inline-block;
  padding: 0.1em 0.25em; /* 文字周りの余白 */
  color: #444; /* 文字色 */
  background-color: #e7edf3; /* 背景色 */
  border-radius: 3px; /* 角丸 */
  border: solid 1px #d6dde4; /* 枠線 */
}
</style>

<body>
<center>

<BR>
<P>
<FONT size="5">Pythonによるデータの可視化3</FONT><BR>
<FONT size="4">Data Visualization with Python 3</FONT>
<FONT size="3">COvid-19と回帰分析</FONT>
</P>  

<BR>

<div class="parent">
 <div class="child2">
実効再生産数の回帰直線をエイヤッと引いてみる。　
<br>
</div>
</div>

<div2>
<img src="DaylyNo_vs_Re2021.9.22-12.9wLR.png" alt="No.vs.RewLR" width="700"> 
<br>
</div2>

<div class="parent">
 <div class="child2">
データの数が増えると直線近似は良くないように思えます。そこで、
指数関数でのフィッティングを、numpyのployfit関数を用いて、いろいろと試みました。

ここで、2021/9/23を起点とした日数を\(x\)として、実効再生産数を\(y\)とします。

\(x\)の2次式の指数関数とし、
ウエイト(\(w\))を\(y\)、または、\(y^2\)とした場合のfittingの結果は、以下のようになりました。
<ul>
<li>\(w=y \ \) の場合
  <ul>
    <li>  2021/12/25までのデータを使用した場合
　　　\(y = \exp(-0.434656175 + 0.00262067149*x + 4.83403391e-05*x^2) \)
    <li>　2022/1/1までのデータを使用した場合
　　　\(y = \exp( -0.42786221 + 0.00214405078*x + 5.39384081e-05*x^2) \)
    <li>　2022/1/2までのデータを使用した場合
　　　\(y = \exp( -0.42562941 + 0.00199172574*x+ 5.567162707e-05 *x^2) \)
  </ul>  
<li>\(w=y^2\)の場合
  <ul>
    <li>  2021/12/25までのデータを使用した場合
　　　\(y = \exp(-0.410929621 + 0.00205032382*x + 5.35490199e-05*x^2)\)
    <li>　2022/1/1までのデータを使用した場合
　　　\(y = \exp(-0.406312266 + 0.00179863723*x + 5.60764465e-05*x^2)\)
    <li>　2022/1/2までのデータを使用した場合
　　　\(y = \exp(-0.402308679 + 0.00157437280*x + 5.83468693e-05*x^2)\)
  </ul>  
</ul>
これらを図示すると以下のようになります。\(w=y^2\)の場合には、データの数が増えても、再帰曲線は、
ほとんど変化しないことが分かります。
<div2>
<img src="DaylyNo_vs_Re2021.9.22-01.02withRC.png" alt="No.vs.RewLR" width="900"> 
<br>
</div2>
<br>
作成したプログラムについては、
  <a href="DataVis3Program.html">
  ここ</a>
をご覧ください。
<br>
<br>
2021年12月20日ころからは、オミクロン株の確認が増えています。その様子は、実効再生産数と1日ごとの感染者数
から見て取れます。ところが、2022年1月9日を境に実効再生産数は減少に転じています。
これは、どのように解釈すれば良いのでしょうか。


<div2>
<img src="DaylyNo_vs_Re2021.9.22-2022.1.18withRC.png" alt="No.vs.RewRC" width="900"> 
<br>
</div2>


</center>
</body>

